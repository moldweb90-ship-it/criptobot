<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RSI Strategy - Crypto Bot</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }

    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .strategy-info {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    .strategy-info h2 {
      color: #2d3748;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .strategy-rules {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .rule-card {
      background: #f8fafc;
      border-radius: 12px;
      padding: 20px;
      border-left: 4px solid #4299e1;
    }

    .rule-card.long {
      border-left-color: #48bb78;
    }

    .rule-card.short {
      border-left-color: #f56565;
    }

    .rule-title {
      font-weight: 700;
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: #2d3748;
    }

    .rule-desc {
      color: #718096;
      line-height: 1.6;
    }

    .crypto-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 15px;
      margin-bottom: 30px;
    }

    .crypto-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 15px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease;
      min-height: 220px;
    }

    .crypto-card:hover {
      transform: translateY(-5px);
    }

    .header-card {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .icon {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
      color: white;
    }

    .icon.btc { background: linear-gradient(135deg, #f7931a 0%, #ffa726 100%); }
    .icon.eth { background: linear-gradient(135deg, #627eea 0%, #8c9eff 100%); }
    .icon.sol { background: linear-gradient(135deg, #9945ff 0%, #14f195 100%); }
    .icon.xrp { background: linear-gradient(135deg, #23292f 0%, #4a90e2 100%); }
    .icon.bnb { background: linear-gradient(135deg, #f3ba2f 0%, #f7d794 100%); }
    .icon.doge { background: linear-gradient(135deg, #c2a633 0%, #d4c17d 100%); }

    .title {
      font-size: 14px;
      font-weight: 700;
      color: #2d3748;
    }

    .subtitle {
      font-size: 10px;
      color: #718096;
      margin-top: 2px;
    }

    .price-display {
      text-align: center;
      margin: 15px 0;
    }

    .price {
      font-size: 20px;
      font-weight: 800;
      color: #2d3748;
      margin-bottom: 4px;
      transition: all 0.3s ease;
    }

    .change {
      font-size: 16px;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 12px;
      display: inline-block;
    }

    .change.positive {
      background: #c6f6d5;
      color: #22543d;
    }

    .change.negative {
      background: #fed7d7;
      color: #742a2a;
    }

    .rsi-indicator {
      text-align: center;
      margin: 15px 0;
      padding: 10px;
      border-radius: 8px;
      background: #f8fafc;
    }

    .rsi-value {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 5px;
    }

    .rsi-value.oversold {
      color: #48bb78;
    }

    .rsi-value.overbought {
      color: #f56565;
    }

    .rsi-value.neutral {
      color: #718096;
    }

    .rsi-label {
      font-size: 12px;
      color: #718096;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .rsi-signal {
      text-align: center;
      margin: 10px 0;
      padding: 8px;
      border-radius: 6px;
      font-weight: 700;
      font-size: 14px;
    }

    .rsi-signal.long {
      background: #c6f6d5;
      color: #22543d;
    }

    .rsi-signal.short {
      background: #fed7d7;
      color: #742a2a;
    }

    .rsi-signal.neutral {
      background: #e2e8f0;
      color: #718096;
    }

    .stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
      margin-top: 12px;
    }

    .stat {
      font-size: 11px;
      color: #718096;
    }

    .stat-value {
      font-weight: 600;
      color: #2d3748;
    }

    .connection-status {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 15px;
      font-size: 12px;
      color: #718096;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #48bb78;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* –ë—É—Ä–≥–µ—Ä–Ω–æ–µ –º–µ–Ω—é */
    .burger-menu {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .burger-button {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 50px;
      height: 50px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      transition: all 0.3s ease;
    }

    .burger-line {
      width: 24px;
      height: 3px;
      background: #2d3748;
      margin: 2px 0;
      transition: all 0.3s ease;
      border-radius: 2px;
    }

    .burger-button:hover .burger-line {
      background: #4299e1;
    }

    .burger-button.active .burger-line:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }

    .burger-button.active .burger-line:nth-child(2) {
      opacity: 0;
    }

    .burger-button.active .burger-line:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -6px);
    }

    .burger-menu-content {
      position: absolute;
      top: 60px;
      left: 0;
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      min-width: 250px;
      max-width: 300px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-20px);
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .burger-menu-content.active {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .burger-menu-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      text-align: center;
    }

    .burger-menu-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .burger-menu-subtitle {
      font-size: 12px;
      opacity: 0.9;
    }

    .burger-menu-items {
      padding: 10px 0;
    }

    .burger-menu-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      color: #2d3748;
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }

    .burger-menu-item:hover {
      background: #f7fafc;
      border-left-color: #4299e1;
      color: #4299e1;
    }

    .burger-menu-item.active {
      background: #e6fffa;
      border-left-color: #38a169;
      color: #38a169;
    }

    .burger-menu-icon {
      font-size: 20px;
      margin-right: 12px;
      width: 24px;
      text-align: center;
    }

    .burger-menu-text {
      font-weight: 600;
      font-size: 14px;
    }

    .burger-menu-desc {
      font-size: 11px;
      color: #718096;
      margin-top: 2px;
    }

    .burger-menu-divider {
      height: 1px;
      background: #e2e8f0;
      margin: 10px 20px;
    }

    @media (max-width: 768px) {
      .crypto-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .strategy-rules {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- –ë—É—Ä–≥–µ—Ä–Ω–æ–µ –º–µ–Ω—é -->
  <div class="burger-menu">
    <button class="burger-button" id="burgerButton">
      <div class="burger-line"></div>
      <div class="burger-line"></div>
      <div class="burger-line"></div>
    </button>
    
    <div class="burger-menu-content" id="burgerMenuContent">
      <div class="burger-menu-header">
        <div class="burger-menu-title">üéØ Crypto Bot</div>
        <div class="burger-menu-subtitle">–¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</div>
      </div>
      
      <div class="burger-menu-items">
        <a href="/" class="burger-menu-item">
          <div class="burger-menu-icon">üè†</div>
          <div>
            <div class="burger-menu-text">–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</div>
            <div class="burger-menu-desc">–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è TP/SL</div>
          </div>
        </a>
        
        <a href="/rsi" class="burger-menu-item active">
          <div class="burger-menu-icon">üìä</div>
          <div>
            <div class="burger-menu-text">RSI —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</div>
            <div class="burger-menu-desc">–≠–∫—Å—Ç—Ä–µ–º—É–º—ã RSI</div>
          </div>
        </a>
        
        <div class="burger-menu-divider"></div>
        
        <a href="#" class="burger-menu-item">
          <div class="burger-menu-icon">‚öôÔ∏è</div>
          <div>
            <div class="burger-menu-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="burger-menu-desc">–°–∫–æ—Ä–æ...</div>
          </div>
        </a>
        
        <a href="#" class="burger-menu-item">
          <div class="burger-menu-icon">üìà</div>
          <div>
            <div class="burger-menu-text">MACD —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</div>
            <div class="burger-menu-desc">–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="header">
      <h1>üìä RSI Strategy</h1>
      <p>–¢–æ—Ä–≥–æ–≤–ª—è –ø–æ —ç–∫—Å—Ç—Ä–µ–º—É–º–∞–º RSI (Relative Strength Index)</p>
    </div>

    <div class="strategy-info">
      <h2>üéØ –ü—Ä–∞–≤–∏–ª–∞ RSI —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</h2>
      <div class="strategy-rules">
        <div class="rule-card long">
          <div class="rule-title">üü¢ LONG —Å–∏–≥–Ω–∞–ª</div>
          <div class="rule-desc">
            RSI ‚â§ 25 (–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å)<br>
            –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏<br>
            TP: 0.69%, SL: 0.31%
          </div>
        </div>
        <div class="rule-card short">
          <div class="rule-title">üî¥ SHORT —Å–∏–≥–Ω–∞–ª</div>
          <div class="rule-desc">
            RSI ‚â• 75 (–ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å)<br>
            –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏<br>
            TP: 0.69%, SL: 0.31%
          </div>
        </div>
        <div class="rule-card">
          <div class="rule-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
          <div class="rule-desc">
            –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: $50<br>
            –¢–∞–π–º—Ñ—Ä–µ–π–º: 3 –º–∏–Ω—É—Ç—ã<br>
            R:R = 1:2.23
          </div>
        </div>
      </div>
    </div>

    <div class="crypto-grid" id="cryptoGrid">
      <!-- –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>
  </div>

  <script>
    // –ë—É—Ä–≥–µ—Ä–Ω–æ–µ –º–µ–Ω—é
    document.addEventListener('DOMContentLoaded', function() {
      const burgerButton = document.getElementById('burgerButton');
      const burgerMenuContent = document.getElementById('burgerMenuContent');
      
      burgerButton.addEventListener('click', function() {
        burgerButton.classList.toggle('active');
        burgerMenuContent.classList.toggle('active');
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
      document.addEventListener('click', function(event) {
        if (!burgerButton.contains(event.target) && !burgerMenuContent.contains(event.target)) {
          burgerButton.classList.remove('active');
          burgerMenuContent.classList.remove('active');
        }
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—É–Ω–∫—Ç –º–µ–Ω—é
      const menuItems = document.querySelectorAll('.burger-menu-item');
      menuItems.forEach(item => {
        item.addEventListener('click', function() {
          burgerButton.classList.remove('active');
          burgerMenuContent.classList.remove('active');
        });
      });
    });

    // –î–∞–Ω–Ω—ã–µ –¥–ª—è RSI —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    let lastPrices = {};
    let rsiData = {};
    let openPositions = [];
    let closedDeals = [];
    let currentBalance = 1000; // –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
    let realizedPnL = 0;
    let totalCommissions = 0;
    let cooldownSymbols = {};
    
    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è RSI —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    const FUTURES_TAKER_FEE = 0.0004; // 0.04% –∫–æ–º–∏—Å—Å–∏—è taker
    const POSITION_SIZE_USD = 50; // –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö
    const RSI_LONG_THRESHOLD = 25; // RSI –¥–ª—è LONG
    const RSI_SHORT_THRESHOLD = 75; // RSI –¥–ª—è SHORT
    
    // WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    let ws = null;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
      initializeCryptoGrid();
      connectWebSocket();
    });
    
    function initializeCryptoGrid() {
      const cryptos = [
        { symbol: 'BTCUSDT', name: 'Bitcoin', icon: '‚Çø' },
        { symbol: 'ETHUSDT', name: 'Ethereum', icon: 'Œû' },
        { symbol: 'SOLUSDT', name: 'Solana', icon: '‚óé' },
        { symbol: 'XRPUSDT', name: 'Ripple', icon: 'X' },
        { symbol: 'BNBUSDT', name: 'Binance Coin', icon: 'B' },
        { symbol: 'DOGEUSDT', name: 'Dogecoin', icon: 'ƒê' }
      ];
      
      const grid = document.getElementById('cryptoGrid');
      grid.innerHTML = '';
      
      cryptos.forEach(crypto => {
        const card = createCryptoCard(crypto);
        grid.appendChild(card);
      });
    }
    
    function createCryptoCard(crypto) {
      const card = document.createElement('div');
      card.className = 'crypto-card';
      card.id = `card-${crypto.symbol}`;
      
      const iconClass = crypto.symbol.toLowerCase().replace('usdt', '');
      
      card.innerHTML = `
        <div class="header-card">
          <div class="icon ${iconClass}">${crypto.icon}</div>
          <div>
            <div class="title">${crypto.name}</div>
            <div class="subtitle">${crypto.symbol}/USDT Futures</div>
          </div>
        </div>
        
        <div class="price-display">
          <div class="price" id="price-${crypto.symbol}">$0.00000</div>
          <div class="change" id="change-${crypto.symbol}">+0.00%</div>
        </div>
        
        <div class="rsi-indicator">
          <div class="rsi-value neutral" id="rsi-${crypto.symbol}">50.0</div>
          <div class="rsi-label">RSI (14)</div>
        </div>
        
        <div class="rsi-signal neutral" id="signal-${crypto.symbol}">
          –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ
        </div>
        
        <div class="stats">
          <div class="stat">
            <div>24h High</div>
            <div class="stat-value" id="high-${crypto.symbol}">$0.00000</div>
          </div>
          <div class="stat">
            <div>24h Low</div>
            <div class="stat-value" id="low-${crypto.symbol}">$0.00000</div>
          </div>
        </div>
        
        <div class="connection-status">
          <div class="status-dot"></div>
          <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Binance Futures</span>
        </div>
      `;
      
      return card;
    }
    
    function connectWebSocket() {
      const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
      const wsUrl = `${protocol}//${window.location.host}`;
      
      ws = new WebSocket(wsUrl);
      
      ws.onopen = function() {
        console.log('üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É');
      };
      
    ws.onmessage = function(event) {
      try {
        const message = JSON.parse(event.data);
        
        if (message.type === 'prices') {
          updatePrices(message.data);
        } else if (message.type === 'analytics3m') {
          updateAnalytics3m(message.data);
        }
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
      }
    };
      
      ws.onclose = function() {
        console.log('üîå WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ');
        setTimeout(connectWebSocket, 5000);
      };
      
      ws.onerror = function(error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ WebSocket:', error);
      };
    }
    
    function updatePrices(data) {
      Object.keys(data).forEach(symbol => {
        if (data[symbol] && data[symbol].futures) {
          lastPrices[symbol] = data[symbol].futures.price;
          
          const priceEl = document.getElementById(`price-${symbol}`);
          const changeEl = document.getElementById(`change-${symbol}`);
          const highEl = document.getElementById(`high-${symbol}`);
          const lowEl = document.getElementById(`low-${symbol}`);
          
          if (priceEl) {
            priceEl.textContent = `$${data[symbol].futures.price.toLocaleString('en-US', { minimumFractionDigits: 5, maximumFractionDigits: 5 })}`;
          }
          
          if (changeEl) {
            changeEl.textContent = `${data[symbol].futures.change24h >= 0 ? '+' : ''}${data[symbol].futures.change24h.toFixed(2)}%`;
            changeEl.className = `change ${data[symbol].futures.change24h >= 0 ? 'positive' : 'negative'}`;
          }
          
          if (highEl) {
            highEl.textContent = `$${data[symbol].futures.high24h.toLocaleString('en-US', { minimumFractionDigits: 5, maximumFractionDigits: 5 })}`;
          }
          
          if (lowEl) {
            lowEl.textContent = `$${data[symbol].futures.low24h.toLocaleString('en-US', { minimumFractionDigits: 5, maximumFractionDigits: 5 })}`;
          }
        }
      });
    }
    
    function updateAnalytics3m(data) {
      Object.keys(data).forEach(symbol => {
        if (data[symbol] && data[symbol].rsi !== undefined) {
          rsiData[symbol] = data[symbol].rsi;
          
          const rsiEl = document.getElementById(`rsi-${symbol}`);
          const signalEl = document.getElementById(`signal-${symbol}`);
          
          if (rsiEl && signalEl) {
            const rsi = data[symbol].rsi;
            rsiEl.textContent = rsi.toFixed(2);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç RSI
            rsiEl.className = 'rsi-value';
            if (rsi <= RSI_LONG_THRESHOLD) {
              rsiEl.classList.add('oversold');
            } else if (rsi >= RSI_SHORT_THRESHOLD) {
              rsiEl.classList.add('overbought');
            } else {
              rsiEl.classList.add('neutral');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏–≥–Ω–∞–ª
            signalEl.className = 'rsi-signal';
            if (rsi <= RSI_LONG_THRESHOLD) {
              signalEl.textContent = 'üü¢ LONG';
              signalEl.classList.add('long');
              checkRSISignal(symbol, 'LONG', rsi);
            } else if (rsi >= RSI_SHORT_THRESHOLD) {
              signalEl.textContent = 'üî¥ SHORT';
              signalEl.classList.add('short');
              checkRSISignal(symbol, 'SHORT', rsi);
            } else {
              signalEl.textContent = '‚ö™ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ';
              signalEl.classList.add('neutral');
            }
          }
        }
      });
    }
    
    function checkRSISignal(symbol, direction, rsi) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏
      const existingPosition = openPositions.find(pos => pos.symbol === symbol);
      if (existingPosition) {
        return;
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—É–ª–¥–∞—É–Ω
      if (cooldownSymbols[symbol]) {
        const cooldownTime = 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞
        const timeSinceClose = Date.now() - cooldownSymbols[symbol];
        if (timeSinceClose < cooldownTime) {
          return;
        }
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
      const requiredBalance = POSITION_SIZE_USD + (POSITION_SIZE_USD * FUTURES_TAKER_FEE);
      if (currentBalance < requiredBalance) {
        console.log(`‚ùå ${symbol}: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è RSI —Å–¥–µ–ª–∫–∏`);
        return;
      }
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
      const entryPrice = lastPrices[symbol];
      if (entryPrice) {
        openRSIPosition(symbol, direction, entryPrice, rsi);
      }
    }
    
    function openRSIPosition(symbol, direction, entryPrice, rsi) {
      const volume = POSITION_SIZE_USD / entryPrice;
      const openCommission = POSITION_SIZE_USD * FUTURES_TAKER_FEE;
      
      // RSI —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: TP 0.69%, SL 0.31%
      const tpPrice = direction === 'LONG' 
        ? entryPrice * (1 + 0.69 / 100) 
        : entryPrice * (1 - 0.69 / 100);
      const slPrice = direction === 'LONG' 
        ? entryPrice * (1 - 0.31 / 100) 
        : entryPrice * (1 + 0.31 / 100);
      
      const position = {
        id: Date.now(),
        symbol: symbol,
        direction: direction,
        entryPrice: entryPrice,
        volume: volume,
        amountUSD: POSITION_SIZE_USD,
        tpPercent: 0.69,
        slPercent: 0.31,
        tpPrice: tpPrice,
        slPrice: slPrice,
        openCommission: openCommission,
        closeCommission: 0,
        totalCommission: openCommission,
        confidence: rsi <= RSI_LONG_THRESHOLD ? 85 : 85, // RSI —ç–∫—Å—Ç—Ä–µ–º—É–º—ã = –≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
        openTime: Date.now(),
        currentPrice: entryPrice,
        unrealizedPnL: 0,
        grossPnL: 0,
        netPnL: 0,
        strategy: 'RSI'
      };
      
      openPositions.push(position);
      currentBalance -= (POSITION_SIZE_USD + openCommission);
      totalCommissions += openCommission;
      
      console.log(`üöÄ RSI –ü–û–ó–ò–¶–ò–Ø: ${symbol} ${direction} @ $${entryPrice.toFixed(5)}`);
      console.log(`   RSI: ${rsi.toFixed(1)}, TP: $${tpPrice.toFixed(5)}, SL: $${slPrice.toFixed(5)}`);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫—É–ª–¥–∞—É–Ω
      cooldownSymbols[symbol] = Date.now();
    }
    
    // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ TP/SL –¥–ª—è RSI –ø–æ–∑–∏—Ü–∏–π
    setInterval(() => {
      if (openPositions.length > 0) {
        openPositions.forEach((position, index) => {
          const currentPrice = lastPrices[position.symbol];
          if (currentPrice) {
            position.currentPrice = currentPrice;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ TP/SL
            if (position.direction === 'LONG' && currentPrice >= position.tpPrice) {
              closeRSIPosition(index, position.tpPrice, 'TP');
            } else if (position.direction === 'LONG' && currentPrice <= position.slPrice) {
              closeRSIPosition(index, position.slPrice, 'SL');
            } else if (position.direction === 'SHORT' && currentPrice <= position.tpPrice) {
              closeRSIPosition(index, position.tpPrice, 'TP');
            } else if (position.direction === 'SHORT' && currentPrice >= position.slPrice) {
              closeRSIPosition(index, position.slPrice, 'SL');
            }
          }
        });
      }
    }, 100);
    
    function closeRSIPosition(positionIndex, exitPrice, reason) {
      const position = openPositions[positionIndex];
      
      const priceDiff = position.direction === 'LONG' 
        ? (exitPrice - position.entryPrice) 
        : (position.entryPrice - exitPrice);
      const grossProfit = priceDiff * position.volume;
      const closeCommission = position.amountUSD * FUTURES_TAKER_FEE;
      const totalCommission = position.openCommission + closeCommission;
      const netProfit = grossProfit - totalCommission;
      
      realizedPnL += netProfit;
      currentBalance += position.amountUSD + netProfit;
      totalCommissions += closeCommission;
      
      const closedDeal = {
        ...position,
        exitPrice: exitPrice,
        closeTime: Date.now(),
        duration: Date.now() - position.openTime,
        closeCommission: closeCommission,
        totalCommission: totalCommission,
        grossProfit: grossProfit,
        netProfit: netProfit,
        realizedPnL: netProfit,
        profitPercent: (grossProfit / position.amountUSD) * 100,
        closeReason: reason
      };
      
      closedDeals.push(closedDeal);
      openPositions.splice(positionIndex, 1);
      
      const emoji = reason === 'TP' ? 'üéØ' : 'üõë';
      console.log(`${emoji} RSI –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: ${position.direction} ${position.symbol} @ $${exitPrice.toFixed(5)}`);
      console.log(`   –ü—Ä–∏—á–∏–Ω–∞: ${reason}, PnL: ${netProfit >= 0 ? '+' : ''}$${netProfit.toFixed(2)}`);
    }
  </script>
</body>
</html>
